CREATE TABLE client (id BIGINT AUTO_INCREMENT, is_active TINYINT(1) DEFAULT '1' NOT NULL, nom VARCHAR(255) NOT NULL, numtel BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE crdmgr_agency (id BIGINT AUTO_INCREMENT, is_active TINYINT(1) DEFAULT '1' NOT NULL, code_agence VARCHAR(100) NOT NULL UNIQUE, nom_agence VARCHAR(100) NOT NULL, adresse VARCHAR(100) NOT NULL, lieu_localisation_code VARCHAR(100) NOT NULL, institution_id BIGINT NOT NULL, telephone VARCHAR(100), email VARCHAR(100), created_by BIGINT NOT NULL, updated_by BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX lieu_localisation_code_idx (lieu_localisation_code), INDEX created_by_idx (created_by), INDEX updated_by_idx (updated_by), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE crdmgr_client (id BIGINT AUTO_INCREMENT, is_active TINYINT(1) DEFAULT '1' NOT NULL, code_client VARCHAR(100) NOT NULL UNIQUE, nom_client VARCHAR(100) NOT NULL, secteuractivite VARCHAR(100), adresse VARCHAR(100) NOT NULL, telephone VARCHAR(100), email VARCHAR(100), lieu_localisation_code VARCHAR(100) NOT NULL, created_by BIGINT NOT NULL, updated_by BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX lieu_localisation_code_idx (lieu_localisation_code), INDEX created_by_idx (created_by), INDEX updated_by_idx (updated_by), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE crdmgr_parameter (id BIGINT AUTO_INCREMENT, is_active TINYINT(1) DEFAULT '1' NOT NULL, type_parametre VARCHAR(100) NOT NULL, code_parametre VARCHAR(100) NOT NULL UNIQUE, label_param VARCHAR(150) NOT NULL, valeur_string DECIMAL(18, 2) NOT NULL, valeur_numeric DECIMAL(18, 2) DEFAULT 0 NOT NULL, description_param VARCHAR(150) NOT NULL, created_by BIGINT NOT NULL, updated_by BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX code_parametre_idx (code_parametre), INDEX created_by_idx (created_by), INDEX updated_by_idx (updated_by), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE crdmgr_user_agency (id BIGINT AUTO_INCREMENT, user_id BIGINT UNIQUE NOT NULL, agence_id BIGINT NOT NULL, created_by BIGINT NOT NULL, updated_by BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX user_id_idx (user_id), INDEX agence_id_idx (agence_id), INDEX created_by_idx (created_by), INDEX updated_by_idx (updated_by), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE estim (id BIGINT AUTO_INCREMENT, is_active TINYINT(1) DEFAULT '1' NOT NULL, largeur DECIMAL(18, 2) NOT NULL, hauteur DECIMAL(18, 2) NOT NULL, nombre_id BIGINT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE estimation (id BIGINT AUTO_INCREMENT, is_active TINYINT(1) DEFAULT '1' NOT NULL, length DECIMAL(18, 2) NOT NULL, width DECIMAL(18, 2), percent DECIMAL(18, 2), price DECIMAL(18, 2), glassprice_id BIGINT, created_by BIGINT, updated_by BIGINT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX glassprice_id_idx (glassprice_id), INDEX created_by_idx (created_by), INDEX updated_by_idx (updated_by), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE glass_price (id BIGINT AUTO_INCREMENT, is_active TINYINT(1) DEFAULT '1' NOT NULL, label VARCHAR(100) NOT NULL, type VARCHAR(100) NOT NULL, price DECIMAL(18, 2), created_by BIGINT, updated_by BIGINT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX created_by_idx (created_by), INDEX updated_by_idx (updated_by), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE rd_detail_mirroir (id BIGINT AUTO_INCREMENT, mirroir_id BIGINT NOT NULL, largeur_min DECIMAL(18, 2) DEFAULT 1 NOT NULL, hauteur_min DECIMAL(18, 2) DEFAULT 1 NOT NULL, rais_bas DECIMAL(18, 2) NOT NULL, rais_haut DECIMAL(18, 2) NOT NULL, dormant DECIMAL(18, 2) NOT NULL, hauteur_couvre_joint DECIMAL(18, 2) NOT NULL, largeur_couvre_joint DECIMAL(18, 2) NOT NULL, sernie DECIMAL(18, 2) NOT NULL, chicone DECIMAL(18, 2) NOT NULL, traverse DECIMAL(18, 2) NOT NULL, largeur_vitre DECIMAL(18, 2) DEFAULT 0 NOT NULL, hauteur_vitre DECIMAL(18, 2) DEFAULT 0 NOT NULL, hauteur_dormant DECIMAL(18, 2) DEFAULT 0 NOT NULL, largeur_dormant DECIMAL(18, 2) DEFAULT 0 NOT NULL, hauteur_parclose30 DECIMAL(18, 2) DEFAULT 0 NOT NULL, largeur_parclose30 DECIMAL(18, 2) DEFAULT 0 NOT NULL, hauteur_zporte DECIMAL(18, 2) DEFAULT 0 NOT NULL, largeur_zporte DECIMAL(18, 2) DEFAULT 0 NOT NULL, traverse140 DECIMAL(18, 2) DEFAULT 0 NOT NULL, hauteur_cadre DECIMAL(18, 2) DEFAULT 0 NOT NULL, largeur_cadre DECIMAL(18, 2) DEFAULT 0 NOT NULL, ljb DECIMAL(18, 2) NOT NULL, hjb DECIMAL(18, 2) NOT NULL, quantite DECIMAL(18, 2) DEFAULT 0 NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX mirroir_id_idx (mirroir_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE rd_facture (id BIGINT AUTO_INCREMENT, detailmirroir_id BIGINT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX detailmirroir_id_idx (detailmirroir_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE rd_mirroir (id BIGINT AUTO_INCREMENT, is_active TINYINT(1) DEFAULT '1' NOT NULL, largeur DECIMAL(18, 2) NOT NULL, hauteur DECIMAL(18, 2) NOT NULL, nombre_id BIGINT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE devis (id BIGINT AUTO_INCREMENT, is_active TINYINT(1) DEFAULT '1' NOT NULL, largeur DECIMAL(18, 2) NOT NULL, hauteur DECIMAL(18, 2) NOT NULL, type DECIMAL(18, 2) NOT NULL, prix DECIMAL(18, 2) NOT NULL, codetype BIGINT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE sf_guard_forgot_password (id BIGINT AUTO_INCREMENT, user_id BIGINT NOT NULL, unique_key VARCHAR(255), expires_at DATETIME NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX user_id_idx (user_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE sf_guard_group (id BIGINT AUTO_INCREMENT, name VARCHAR(255) UNIQUE, description TEXT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE sf_guard_group_permission (group_id BIGINT, permission_id BIGINT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(group_id, permission_id)) ENGINE = INNODB;
CREATE TABLE sf_guard_permission (id BIGINT AUTO_INCREMENT, name VARCHAR(255) UNIQUE, description TEXT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE sf_guard_remember_key (id BIGINT AUTO_INCREMENT, user_id BIGINT, remember_key VARCHAR(32), ip_address VARCHAR(50), created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX user_id_idx (user_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE sf_guard_user (id BIGINT AUTO_INCREMENT, first_name VARCHAR(255), last_name VARCHAR(255), email_address VARCHAR(255) NOT NULL UNIQUE, username VARCHAR(128) NOT NULL UNIQUE, algorithm VARCHAR(128) DEFAULT 'sha1' NOT NULL, salt VARCHAR(128), password VARCHAR(128), is_active TINYINT(1) DEFAULT '1', is_super_admin TINYINT(1) DEFAULT '0', last_login DATETIME, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, INDEX is_active_idx_idx (is_active), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE sf_guard_user_group (user_id BIGINT, group_id BIGINT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(user_id, group_id)) ENGINE = INNODB;
CREATE TABLE sf_guard_user_permission (user_id BIGINT, permission_id BIGINT, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, PRIMARY KEY(user_id, permission_id)) ENGINE = INNODB;
ALTER TABLE crdmgr_agency ADD CONSTRAINT crdmgr_agency_updated_by_sf_guard_user_id FOREIGN KEY (updated_by) REFERENCES sf_guard_user(id);
ALTER TABLE crdmgr_agency ADD CONSTRAINT crdmgr_agency_created_by_sf_guard_user_id FOREIGN KEY (created_by) REFERENCES sf_guard_user(id);
ALTER TABLE crdmgr_agency ADD CONSTRAINT clcc FOREIGN KEY (lieu_localisation_code) REFERENCES crdmgr_parameter(code_parametre);
ALTER TABLE crdmgr_client ADD CONSTRAINT crdmgr_client_updated_by_sf_guard_user_id FOREIGN KEY (updated_by) REFERENCES sf_guard_user(id);
ALTER TABLE crdmgr_client ADD CONSTRAINT crdmgr_client_created_by_sf_guard_user_id FOREIGN KEY (created_by) REFERENCES sf_guard_user(id);
ALTER TABLE crdmgr_client ADD CONSTRAINT clcc_1 FOREIGN KEY (lieu_localisation_code) REFERENCES crdmgr_parameter(code_parametre);
ALTER TABLE crdmgr_parameter ADD CONSTRAINT crdmgr_parameter_updated_by_sf_guard_user_id FOREIGN KEY (updated_by) REFERENCES sf_guard_user(id);
ALTER TABLE crdmgr_parameter ADD CONSTRAINT crdmgr_parameter_created_by_sf_guard_user_id FOREIGN KEY (created_by) REFERENCES sf_guard_user(id);
ALTER TABLE crdmgr_user_agency ADD CONSTRAINT crdmgr_user_agency_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id);
ALTER TABLE crdmgr_user_agency ADD CONSTRAINT crdmgr_user_agency_updated_by_sf_guard_user_id FOREIGN KEY (updated_by) REFERENCES sf_guard_user(id);
ALTER TABLE crdmgr_user_agency ADD CONSTRAINT crdmgr_user_agency_created_by_sf_guard_user_id FOREIGN KEY (created_by) REFERENCES sf_guard_user(id);
ALTER TABLE crdmgr_user_agency ADD CONSTRAINT crdmgr_user_agency_agence_id_crdmgr_agency_id FOREIGN KEY (agence_id) REFERENCES crdmgr_agency(id);
ALTER TABLE estimation ADD CONSTRAINT estimation_updated_by_sf_guard_user_id FOREIGN KEY (updated_by) REFERENCES sf_guard_user(id);
ALTER TABLE estimation ADD CONSTRAINT estimation_glassprice_id_glass_price_id FOREIGN KEY (glassprice_id) REFERENCES glass_price(id);
ALTER TABLE estimation ADD CONSTRAINT estimation_created_by_sf_guard_user_id FOREIGN KEY (created_by) REFERENCES sf_guard_user(id);
ALTER TABLE glass_price ADD CONSTRAINT glass_price_updated_by_sf_guard_user_id FOREIGN KEY (updated_by) REFERENCES sf_guard_user(id);
ALTER TABLE glass_price ADD CONSTRAINT glass_price_created_by_sf_guard_user_id FOREIGN KEY (created_by) REFERENCES sf_guard_user(id);
ALTER TABLE rd_detail_mirroir ADD CONSTRAINT rd_detail_mirroir_mirroir_id_rd_mirroir_id FOREIGN KEY (mirroir_id) REFERENCES rd_mirroir(id);
ALTER TABLE rd_facture ADD CONSTRAINT rd_facture_detailmirroir_id_rd_detail_mirroir_id FOREIGN KEY (detailmirroir_id) REFERENCES rd_detail_mirroir(id);
ALTER TABLE sf_guard_forgot_password ADD CONSTRAINT sf_guard_forgot_password_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_group_permission ADD CONSTRAINT sf_guard_group_permission_permission_id_sf_guard_permission_id FOREIGN KEY (permission_id) REFERENCES sf_guard_permission(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_group_permission ADD CONSTRAINT sf_guard_group_permission_group_id_sf_guard_group_id FOREIGN KEY (group_id) REFERENCES sf_guard_group(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_remember_key ADD CONSTRAINT sf_guard_remember_key_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_user_group ADD CONSTRAINT sf_guard_user_group_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_user_group ADD CONSTRAINT sf_guard_user_group_group_id_sf_guard_group_id FOREIGN KEY (group_id) REFERENCES sf_guard_group(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_user_permission ADD CONSTRAINT sf_guard_user_permission_user_id_sf_guard_user_id FOREIGN KEY (user_id) REFERENCES sf_guard_user(id) ON DELETE CASCADE;
ALTER TABLE sf_guard_user_permission ADD CONSTRAINT sf_guard_user_permission_permission_id_sf_guard_permission_id FOREIGN KEY (permission_id) REFERENCES sf_guard_permission(id) ON DELETE CASCADE;
